<!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spin Kelompok (Roda)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      text-align: center;
      padding: 20px;
    }
    canvas {
      margin: 20px auto;
      display: block;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    .groups {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    .group {
      background: white;
      padding: 10px;
      width: 200px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
      text-align: left;
    }
  </style>
</head>
<body><h1>ðŸŽ¡ Spin Pembagian Kelompok</h1>
<p>Nama yang sudah masuk kelompok akan otomatis hilang dari roda</p><canvas id="wheel" width="350" height="350"></canvas> <button onclick="spin()">SPIN</button>

<div class="groups">
  <div class="group"><b>Kelompok 1 (4)</b><ul id="k1"></ul></div>
  <div class="group"><b>Kelompok 2 (4)</b><ul id="k2"></ul></div>
  <div class="group"><b>Kelompok 3 (3)</b><ul id="k3"></ul></div>
  <div class="group"><b>Kelompok 4 (3)</b><ul id="k4"></ul></div>
</div><script>
let names = [
  "Anisa Apriliyanti","Anisa Syifa Febriani","Afwa Mumtajah","Chairul Fatkan",
  "Eni Aisah Fitri","Fadliatul Najiah","Hasan Amirul Mulya","Hazria Ahdayani",
  "Meila Anjani","Syahrul Maulana Yusuf","Siti Nuraeni","Winda",
  "Fathur Febriansyah","M. Hafidz"
];

let groups = [
  {id:'k1', max:4, label:'Kelompok 1'},
  {id:'k2', max:4, label:'Kelompok 2'},
  {id:'k3', max:3, label:'Kelompok 3'},
  {id:'k4', max:3, label:'Kelompok 4'}
];
let currentGroup = 0;

const canvas = document.getElementById('wheel');
const ctx = canvas.getContext('2d');
let angle = 0;

const clickSound = new Audio('https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg');
const popSound = new Audio('https://actions.google.com/sounds/v1/cartoon/pop.ogg');

function drawWheel() {
  const radius = canvas.width / 2;
  const slice = (2 * Math.PI) / names.length;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  names.forEach((name, i) => {
    ctx.beginPath();
    ctx.fillStyle = ['#4CAF50','#2196F3','#FFC107','#F44336'][i % 4];
    ctx.moveTo(radius, radius);
    ctx.arc(radius, radius, radius, angle + i * slice, angle + (i+1) * slice);
    ctx.fill();

    ctx.save();
    ctx.translate(radius, radius);
    ctx.rotate(angle + (i + 0.5) * slice);
    ctx.textAlign = 'right';
    ctx.fillStyle = '#fff';
    ctx.font = '14px Arial';
    ctx.fillText(name, radius - 10, 5);
    ctx.restore();
  });
}

function speak(text){
  let u = new SpeechSynthesisUtterance(text);
  u.lang = 'id-ID';
  speechSynthesis.speak(u);
}

function spin() {
  if (names.length === 0) return alert('Semua sudah masuk kelompok');

  if (document.getElementById(groups[currentGroup].id).children.length >= groups[currentGroup].max) {
    currentGroup++;
  }
  if (currentGroup >= groups.length) return;

  clickSound.play();
  let spinAngle = Math.random() * 2000 + 2000;
  let duration = 2000;
  let start = null;

  function animate(timestamp) {
    if (!start) start = timestamp;
    let progress = timestamp - start;
    angle += spinAngle / duration * 0.016;
    drawWheel();
    if (progress < duration) {
      requestAnimationFrame(animate);
    } else {
      let slice = (2 * Math.PI) / names.length;
      let index = Math.floor((2 * Math.PI - (angle % (2 * Math.PI))) / slice) % names.length;
      let chosen = names.splice(index,1)[0];

      popSound.play();
      speak(chosen + ' masuk ' + groups[currentGroup].label);

      let li = document.createElement('li');
      li.textContent = chosen;
      document.getElementById(groups[currentGroup].id).appendChild(li);
      drawWheel();
    }
  }
  requestAnimationFrame(animate);
}

drawWheel();
</script></body>
</html>
